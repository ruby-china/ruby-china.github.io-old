<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh-CN" lang="zh-CN">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>

<title>Ruby on Rails 4.2 发布记 — Ruby on Rails 指南</title>
<link rel="stylesheet" type="text/css" href="stylesheets/style.css" />
<link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />

<link rel="stylesheet" type="text/css" href="stylesheets/syntaxhighlighter/shCore.css" />
<link rel="stylesheet" type="text/css" href="stylesheets/syntaxhighlighter/shThemeRailsGuides.css" />

<link rel="stylesheet" type="text/css" href="stylesheets/fixes.css" />

<link href="images/favicon.ico" rel="shortcut icon" type="image/x-icon" />
</head>
<body class="guide">
  <div id="topNav">
    <div class="wrapper">
      <strong class="more-info-label">更多内容 <a href="http://rubyonrails.org/">rubyonrails.org:</a> </strong>
      <span class="red-button more-info-button">
        更多内容
      </span>
      <ul class="more-info-links s-hidden">
        <li class="more-info"><a href="http://rubyonrails.org/">综览</a></li>
        <li class="more-info"><a href="http://rubyonrails.org/download">下载</a></li>
        <li class="more-info"><a href="http://rubyonrails.org/deploy">部署</a></li>
        <li class="more-info"><a href="https://github.com/rails/rails">源码</a></li>
        <li class="more-info"><a href="http://rubyonrails.org/screencasts">视频</a></li>
        <li class="more-info"><a href="http://rubyonrails.org/documentation">文件</a></li>
        <li class="more-info"><a href="http://rubyonrails.org/community">社群</a></li>
        <li class="more-info"><a href="http://weblog.rubyonrails.org/">Blog</a></li>
      </ul>
    </div>
  </div>
  <div id="header">
    <div class="wrapper clearfix">
      <h1><a href="index.html" title="回首页">Guides.rubyonrails.org</a></h1>
      <ul class="nav">
        <li><a class="nav-item" href="index.html">首页</a></li>
        <li class="guides-index guides-index-large">
          <a href="index.html" id="guidesMenu" class="guides-index-item nav-item">指南目录</a>
          <div id="guides" class="clearfix" style="display: none;">
            <hr />
              <dl class="L">
                <dt>入门</dt>
                <dd><a href="getting_started.html">Rails 入门</a></dd>
                <dt>模型</dt>
                <dd><a href="active_record_basics.html">Active Record 基础</a></dd>
                <dd><a href="active_record_migrations.html">Active Record 数据库迁移</a></dd>
                <dd><a href="active_record_validations.html">Active Record 数据验证</a></dd>
                <dd><a href="active_record_callbacks.html">Active Record 回调</a></dd>
                <dd><a href="association_basics.html">Active Record 关联</a></dd>
                <dd><a href="active_record_querying.html">Active Record 查询</a></dd>
                <dt>视图</dt>
                <dd><a href="layouts_and_rendering.html">Rails 布局和视图渲染</a></dd>
                <dd><a href="form_helpers.html">Action View 表单帮助方法</a></dd>
                <dt>控制器</dt>
                <dd><a href="action_controller_overview.html">Action Controller 简介</a></dd>
                <dd><a href="routing.html">Rails 路由全解</a></dd>
              </dl>
              <dl class="R">
                <dt>深入</dt>
                <dd><a href="active_support_core_extensions.html">Active Support 核心扩展</a></dd>
                <dd><a href="i18n.html">Rails 国际化 API</a></dd>
                <dd><a href="action_mailer_basics.html">Action Mailer 基础</a></dd>
                <dd><a href="security.html">Rails 安全指南</a></dd>
                <dd><a href="debugging_rails_applications.html">调试 Rails 程序</a></dd>
                <dd><a href="configuring.html">设置 Rails 程序</a></dd>
                <dd><a href="command_line.html">Rails 命令行</a></dd>
                <dd><a href="asset_pipeline.html">Asset Pipeline</a></dd>
                <dd><a href="working_with_javascript_in_rails.html">在 Rails 中使用 JavaScript</a></dd>
                <dt>扩展 Rails</dt>
                <dd><a href="rails_on_rack.html">Rails on Rack</a></dd>
                <dd><a href="generators.html">客制与新建 Rails 产生器</a></dd>
                <dd><a href="rails_application_templates.html">Rails 应用程式模版</a></dd>
                <dt>贡献 Ruby on Rails</dt>
                <dd><a href="contributing_to_ruby_on_rails.html">贡献 Ruby on Rails</a></dd>
                <dd><a href="api_documentation_guidelines.html">API 文件准则</a></dd>
                <dd><a href="ruby_on_rails_guides_guidelines.html">Ruby on Rails 指南准则</a></dd>
                <dt>维护方针</dt>
                <dd><a href="maintenance_policy.html">维护方针</a></dd>
                <dt>发布记</dt>
                <dd><a href="upgrading_ruby_on_rails.html">升级 Ruby on Rails</a></dd>
                <dd><a href="4_1_release_notes.html">Ruby on Rails 4.1 发布记</a></dd>
                <dd><a href="4_0_release_notes.html">Ruby on Rails 4.0 发布记</a></dd>
                <dd><a href="3_2_release_notes.html">Ruby on Rails 3.2 发布记</a></dd>
                <dd><a href="3_1_release_notes.html">Ruby on Rails 3.1 发布记</a></dd>
                <dd><a href="3_0_release_notes.html">Ruby on Rails 3.0 发布记</a></dd>
                <dd><a href="2_3_release_notes.html">Ruby on Rails 2.3 发布记</a></dd>
                <dd><a href="2_2_release_notes.html">Ruby on Rails 2.2 发布记</a></dd>
              </dl>
          </div>
        </li>
        <!-- <li><a class="nav-item" href="//github.com/docrails-tw/wiki">参与翻译</a></li> -->
        <li><a class="nav-item" href="https://github.com/ruby-china/guides/blob/master/CONTRIBUTING.md">贡献</a></li>
        <li><a class="nav-item" href="credits.html">致谢</a></li>
        <li class="guides-index guides-index-small">
          <select class="guides-index-item nav-item">
            <option value="index.html">指南目录</option>
              <optgroup label="入门">
                  <option value="getting_started.html">Rails 入门</option>
              </optgroup>
              <optgroup label="模型">
                  <option value="active_record_basics.html">Active Record 基础</option>
                  <option value="active_record_migrations.html">Active Record 数据库迁移</option>
                  <option value="active_record_validations.html">Active Record 数据验证</option>
                  <option value="active_record_callbacks.html">Active Record 回调</option>
                  <option value="association_basics.html">Active Record 关联</option>
                  <option value="active_record_querying.html">Active Record 查询</option>
              </optgroup>
              <optgroup label="视图">
                  <option value="layouts_and_rendering.html">Rails 布局和视图渲染</option>
                  <option value="form_helpers.html">Action View 表单帮助方法</option>
              </optgroup>
              <optgroup label="控制器">
                  <option value="action_controller_overview.html">Action Controller 简介</option>
                  <option value="routing.html">Rails 路由全解</option>
              </optgroup>
              <optgroup label="深入">
                  <option value="active_support_core_extensions.html">Active Support 核心扩展</option>
                  <option value="i18n.html">Rails 国际化 API</option>
                  <option value="action_mailer_basics.html">Action Mailer 基础</option>
                  <option value="security.html">Rails 安全指南</option>
                  <option value="debugging_rails_applications.html">调试 Rails 程序</option>
                  <option value="configuring.html">设置 Rails 程序</option>
                  <option value="command_line.html">Rails 命令行</option>
                  <option value="asset_pipeline.html">Asset Pipeline</option>
                  <option value="working_with_javascript_in_rails.html">在 Rails 中使用 JavaScript</option>
              </optgroup>
              <optgroup label="扩展 Rails">
                  <option value="rails_on_rack.html">Rails on Rack</option>
                  <option value="generators.html">客制与新建 Rails 产生器</option>
                  <option value="rails_application_templates.html">Rails 应用程式模版</option>
              </optgroup>
              <optgroup label="贡献 Ruby on Rails">
                  <option value="contributing_to_ruby_on_rails.html">贡献 Ruby on Rails</option>
                  <option value="api_documentation_guidelines.html">API 文件准则</option>
                  <option value="ruby_on_rails_guides_guidelines.html">Ruby on Rails 指南准则</option>
              </optgroup>
              <optgroup label="维护方针">
                  <option value="maintenance_policy.html">维护方针</option>
              </optgroup>
              <optgroup label="发布记">
                  <option value="upgrading_ruby_on_rails.html">升级 Ruby on Rails</option>
                  <option value="4_1_release_notes.html">Ruby on Rails 4.1 发布记</option>
                  <option value="4_0_release_notes.html">Ruby on Rails 4.0 发布记</option>
                  <option value="3_2_release_notes.html">Ruby on Rails 3.2 发布记</option>
                  <option value="3_1_release_notes.html">Ruby on Rails 3.1 发布记</option>
                  <option value="3_0_release_notes.html">Ruby on Rails 3.0 发布记</option>
                  <option value="2_3_release_notes.html">Ruby on Rails 2.3 发布记</option>
                  <option value="2_2_release_notes.html">Ruby on Rails 2.2 发布记</option>
              </optgroup>
          </select>
        </li>
      </ul>
      </div>
    </div>
  </div>
  <hr class="hide" />

  <div id="feature">
    <div class="wrapper">
      <h2>Ruby on Rails 4.2 发布记</h2><p>Rails 4.2 精华摘要：</p><p>本篇仅记录主要的变化。要了解关于已修复的 Bug、特性变更等，请参考 <a href="https://github.com/rails/rails">Rails GitHub 主页</a>上各个 Gem 的 CHANGELOG 或是 <a href="https://github.com/rails/rails/commits/master">Rails 的提交历史</a>。</p>

                <div id="subCol">
            <h3 class="chapter"><img src="images/chapters_icon.gif" alt="" />Chapters</h3>
            <ol class="chapters">
<li><a href="#%E5%8D%87%E7%BA%A7%E8%87%B3-rails-4.2">升级至 Rails 4.2</a></li>
<li>
<a href="#%E9%87%8D%E8%A6%81%E6%96%B0%E7%89%B9%E6%80%A7">重要新特性</a>

<ul>
<li><a href="#%E5%A4%96%E9%94%AE%E6%94%AF%E6%8F%B4">外键支援</a></li>
</ul>
</li>
<li>
<a href="#railties">Railties</a>

<ul>
<li><a href="#railties-%E7%A7%BB%E9%99%A4">移除</a></li>
<li><a href="#railties-%E5%BC%83%E7%94%A8">弃用</a></li>
<li><a href="#railties-%E5%80%BC%E5%BE%97%E4%B8%80%E6%8F%90%E7%9A%84%E5%8F%98%E5%8C%96">值得一提的变化</a></li>
</ul>
</li>
<li>
<a href="#action-pack">Action Pack</a>

<ul>
<li><a href="#action-pack-%E5%BC%83%E7%94%A8">弃用</a></li>
<li><a href="#action-pack-%E5%80%BC%E5%BE%97%E4%B8%80%E6%8F%90%E7%9A%84%E5%8F%98%E5%8C%96">值得一提的变化</a></li>
</ul>
</li>
<li>
<a href="#action-view">Action View</a>

<ul>
<li><a href="#action-view-%E5%BC%83%E7%94%A8">弃用</a></li>
<li><a href="#action-view-%E5%80%BC%E5%BE%97%E4%B8%80%E6%8F%90%E7%9A%84%E5%8F%98%E5%8C%96">值得一提的变化</a></li>
</ul>
</li>
<li>
<a href="#action-mailer">Action Mailer</a>

<ul>
<li><a href="#action-mailer-%E5%80%BC%E5%BE%97%E4%B8%80%E6%8F%90%E7%9A%84%E5%8F%98%E5%8C%96">值得一提的变化</a></li>
</ul>
</li>
<li>
<a href="#active-record">Active Record</a>

<ul>
<li><a href="#active-record-%E7%A7%BB%E9%99%A4">移除</a></li>
<li><a href="#active-record-%E5%BC%83%E7%94%A8">弃用</a></li>
<li><a href="#active-record-%E5%80%BC%E5%BE%97%E4%B8%80%E6%8F%90%E7%9A%84%E5%8F%98%E5%8C%96">值得一提的变化</a></li>
</ul>
</li>
<li>
<a href="#active-model">Active Model</a>

<ul>
<li><a href="#active-model-%E7%A7%BB%E9%99%A4">移除</a></li>
<li><a href="#active-model-%E5%80%BC%E5%BE%97%E4%B8%80%E6%8F%90%E7%9A%84%E5%8F%98%E5%8C%96">值得一提的变化</a></li>
</ul>
</li>
<li>
<a href="#active-support">Active Support</a>

<ul>
<li><a href="#active-support-%E7%A7%BB%E9%99%A4">移除</a></li>
<li><a href="#%E5%BC%83%E7%94%A8">弃用</a></li>
<li><a href="#%E5%80%BC%E5%BE%97%E4%B8%80%E6%8F%90%E7%9A%84%E5%8F%98%E5%8C%96">值得一提的变化</a></li>
</ul>
</li>
<li><a href="#%E8%87%B4%E8%B0%A2">致谢</a></li>
</ol>

          </div>

    </div>
  </div>

  <div id="container">
    <div class="wrapper">
      <div id="mainCol">
        <h3 id="升级至-rails-4.2">1 升级至 Rails 4.2</h3><p>如果您正试着升级现有的应用程序，最好有广的测试覆盖度。首先应先升级至 4.1，确保应用程序仍正常工作，接着再升上 4.2。升级需要注意的事项在 <a href="upgrading_ruby_on_rails.html#upgrading-from-rails-4-1-to-rails-4-2">Ruby on Rails 升级指南</a>可以找到。</p><h3 id="重要新特性">2 重要新特性</h3><h4 id="外键支援">2.1 外键支援</h4><p>迁移 DSL 现在支援新增、移除外键，也会导出到 <code>schema.rb</code>。目前只有 <code>mysql</code>、<code>mysql2</code> 以及 <code>postgresql</code> 的适配器支援外键。</p><div class="code_container">
<pre class="brush: ruby; gutter: false; toolbar: false">
# add a foreign key to `articles.author_id` referencing `authors.id`
add_foreign_key :articles, :authors

# add a foreign key to `articles.author_id` referencing `users.lng_id`
add_foreign_key :articles, :users, column: :author_id, primary_key: "lng_id"

# remove the foreign key on `accounts.branch_id`
remove_foreign_key :accounts, :branches

# remove the foreign key on `accounts.owner_id`
remove_foreign_key :accounts, column: :owner_id

</pre>
</div>
<p>完整说明请参考 API 文档：<a href="http://api.rubyonrails.org/v4.2.0/classes/ActiveRecord/ConnectionAdapters/SchemaStatements.html#method-i-add_foreign_key">add_foreign_key</a> 和 <a href="http://api.rubyonrails.org/v4.2.0/classes/ActiveRecord/ConnectionAdapters/SchemaStatements.html#method-i-remove_foreign_key">remove_foreign_key</a>。</p><h3 id="railties">3 Railties</h3><p>请参考 <a href="https://github.com/rails/rails/blob/4-2-stable/railties/CHANGELOG.md">CHANGELOG</a> 来了解更多细节。</p><h4 id="railties-移除">3.1 移除</h4>
<ul>
<li>移除 <code>rails application</code> 命令。
(<a href="https://github.com/rails/rails/pull/11616">Pull Request</a>)</li>
</ul>
<h4 id="railties-弃用">3.2 弃用</h4>
<ul>
<li>弃用 <code>Rails::Rack::LogTailer</code>，没有替代方案。
(<a href="https://github.com/rails/rails/commit/84a13e019e93efaa8994b3f8303d635a7702dbce">Commit</a>)</li>
</ul>
<h4 id="railties-值得一提的变化">3.3 值得一提的变化</h4>
<ul>
<li><p>导入 <code>bin/setup</code> 脚本来启动应用程序。
(<a href="https://github.com/rails/rails/pull/15189">Pull Request</a>)</p></li>
<li><p><code>config.assets.digest</code> 在开发模式的缺省值改为 <code>true</code>。
(<a href="https://github.com/rails/rails/pull/15155">Pull Request</a>)</p></li>
<li><p>导入给 <code>rake notes</code> 注册新扩展特性的 API。
(<a href="https://github.com/rails/rails/pull/14379">Pull Request</a>)</p></li>
<li><p>导入 <code>Rails.gem_version</code> 作为返回 <code>Gem::Version.new(Rails.version)</code> 的便捷方法。
(<a href="https://github.com/rails/rails/pull/14101">Pull Request</a>)</p></li>
</ul>
<h3 id="action-pack">4 Action Pack</h3><p>请参考 <a href="https://github.com/rails/rails/blob/4-2-stable/actionpack/CHANGELOG.md">CHANGELOG</a> 来了解更多细节。</p><h4 id="action-pack-弃用">4.1 弃用</h4>
<ul>
<li>
<p>弃用路由的 <code>:to</code> 选项里，<code>:to</code> 可以指向符号或不含井号的字串这两个特性。</p>
<div class="code_container">
<pre class="brush: ruby; gutter: false; toolbar: false">
get '/posts', to: MyRackApp    =&gt; (No change necessary)
get '/posts', to: 'post#index' =&gt; (No change necessary)
get '/posts', to: 'posts'      =&gt; get '/posts', controller: :posts
get '/posts', to: :index       =&gt; get '/posts', action: :index

</pre>
</div>
<p>(<a href="https://github.com/rails/rails/commit/cc26b6b7bccf0eea2e2c1a9ebdcc9d30ca7390d9">Commit</a>)</p>
</li>
</ul>
<h4 id="action-pack-值得一提的变化">4.2 值得一提的变化</h4>
<ul>
<li><p><code>render nothing: true</code> 或渲染 <code>nil</code> 主体不再给响应加一个空白。
(<a href="https://github.com/rails/rails/pull/14883">Pull Request</a>)</p></li>
<li><p>导入 <code>always_permitted_parameters</code> 选项，用来设定全局允许赋值的参数。默认值是
<code>['controller', 'action']</code>。
(<a href="https://github.com/rails/rails/pull/15933">Pull Request</a>)</p></li>
<li>
<p><code>*_filter</code> 方法已经从文档中移除，已经不鼓励使用。偏好使用 <code>*_action</code> 方法：</p>
<div class="code_container">
<pre class="brush: ruby; gutter: false; toolbar: false">
after_filter          =&gt; after_action
append_after_filter   =&gt; append_after_action
append_around_filter  =&gt; append_around_action
append_before_filter  =&gt; append_before_action
around_filter         =&gt; around_action
before_filter         =&gt; before_action
prepend_after_filter  =&gt; prepend_after_action
prepend_around_filter =&gt; prepend_around_action
prepend_before_filter =&gt; prepend_before_action
skip_after_filter     =&gt; skip_after_action
skip_around_filter    =&gt; skip_around_action
skip_before_filter    =&gt; skip_before_action
skip_filter           =&gt; skip_action_callback

</pre>
</div>
<p>若应用程序依赖这些 <code>*_filter</code> 方法，应该使用 <code>*_action</code> 方法替换。
因为 <code>*_filter</code> 方法最终会从 Rails 里拿掉。
(Commit <a href="https://github.com/rails/rails/commit/6c5f43bab8206747a8591435b2aa0ff7051ad3de">1</a>,
<a href="https://github.com/rails/rails/commit/489a8f2a44dc9cea09154ee1ee2557d1f037c7d4">2</a>)</p>
</li>
<li><p>从 RFC-4791 新增 HTTP 方法 <code>MKCALENDAR</code>。
(<a href="https://github.com/rails/rails/pull/15121">Pull Request</a>)</p></li>
<li><p><code>*_fragment.action_controller</code> 通知消息的 Payload 现在包含控制器与动作名称。
(<a href="https://github.com/rails/rails/pull/14137">Pull Request</a>)</p></li>
<li><p>传入 URL 辅助方法的片段现在会自动 Escaped。
(<a href="https://github.com/rails/rails/commit/5460591f0226a9d248b7b4f89186bd5553e7768f">Commit</a>)</p></li>
<li><p>改善路由错误页面，搜索路由支持模糊搜索。
(<a href="https://github.com/rails/rails/pull/14619">Pull Request</a>)</p></li>
<li><p>新增关掉记录 CSRF 失败的选项。
(<a href="https://github.com/rails/rails/pull/14280">Pull Request</a>)</p></li>
</ul>
<h3 id="action-view">5 Action View</h3><p>请参考 <a href="https://github.com/rails/rails/blob/4-2-stable/actionview/CHANGELOG.md">CHANGELOG</a> 来了解更多细节。</p><h4 id="action-view-弃用">5.1 弃用</h4>
<ul>
<li><p>弃用 <code>AbstractController::Base.parent_prefixes</code>。想修改寻找视图的位置，
请覆写 <code>AbstractController::Base.local_prefixes</code>。
(<a href="https://github.com/rails/rails/pull/15026">Pull Request</a>)</p></li>
<li><p>弃用 <code>ActionView::Digestor#digest(name, format, finder, options = {})</code>，
现在参数改用 Hash 传入。
(<a href="https://github.com/rails/rails/pull/14243">Pull Request</a>)</p></li>
</ul>
<h4 id="action-view-值得一提的变化">5.2 值得一提的变化</h4>
<ul>
<li>表单帮助方法针对隐藏栏位不再加上含有行内样式的 <code>&lt;div&gt;</code>。
(<a href="https://github.com/rails/rails/pull/14738">Pull Request</a>)</li>
</ul>
<h3 id="action-mailer">6 Action Mailer</h3><p>请参考 <a href="https://github.com/rails/rails/blob/4-2-stable/actionmailer/CHANGELOG.md">CHANGELOG</a> 来了解更多细节。</p><h4 id="action-mailer-值得一提的变化">6.1 值得一提的变化</h4>
<ul>
<li>添加 <code>show_previews</code> 设定选项，用来在开发环境以外启用 Mailer 预览。
(<a href="https://github.com/rails/rails/pull/15970">Pull Request</a>)</li>
</ul>
<h3 id="active-record">7 Active Record</h3><p>请参考 <a href="https://github.com/rails/rails/blob/4-2-stable/activerecord/CHANGELOG.md">CHANGELOG</a> 来了解更多细节。</p><h4 id="active-record-移除">7.1 移除</h4>
<ul>
<li><p>移除 <code>cache_attributes</code> 以及其它相关的方法，所有的属性现在都会缓存了。
(<a href="https://github.com/rails/rails/pull/15429">Pull Request</a>)</p></li>
<li><p>移除已弃用的方法 <code>ActiveRecord::Base.quoted_locking_column</code>.
(<a href="https://github.com/rails/rails/pull/15612">Pull Request</a>)</p></li>
<li><p>移除已弃用的方法 <code>ActiveRecord::Migrator.proper_table_name</code>。
请改用 <code>ActiveRecord::Migration</code> 的实例方法：<code>proper_table_name</code>。
(<a href="https://github.com/rails/rails/pull/15512">Pull Request</a>)</p></li>
<li><p>移除了未使用的 <code>:timestamp</code> 类型。把所有 <code>timestamp</code> 类型都改为 <code>:datetime</code> 的别名。
修正在 <code>ActiveRecord</code> 之外，栏位类型不一致的问题，譬如 XML 序列化。
(<a href="https://github.com/rails/rails/pull/15184">Pull Request</a>)</p></li>
</ul>
<h4 id="active-record-弃用">7.2 弃用</h4>
<ul>
<li><p>弃用对 <code>has_many :through</code> 自动侦测 counter cache 的支持。要自己对 <code>has_many</code> 与
<code>belongs_to</code> 关联，给 <code>through</code> 的纪录手动设定。
(<a href="https://github.com/rails/rails/pull/15754">Pull Request</a>)</p></li>
<li><p>弃用 <code>serialized_attributes</code> without replacement.
(<a href="https://github.com/rails/rails/pull/15704">Pull Request</a>)</p></li>
<li><p>弃用了当栏位不存在时，还会从 <code>column_for_attribute</code> 返回 <code>nil</code> 的情况。
Rails 5.0 将会返回 Null Object。
(<a href="https://github.com/rails/rails/pull/15878">Pull Request</a>)</p></li>
<li><p>弃用了 <code>serialized_attributes</code>，没有替代方案。
(<a href="https://github.com/rails/rails/pull/15704">Pull Request</a>)</p></li>
<li><p>依赖实例状态（有定义接受参数的作用域）的关联现在不能使用 <code>.joins</code>、<code>.preload</code> 以及 <code>.eager_load</code> 了。
(<a href="https://github.com/rails/rails/commit/ed56e596a0467390011bc9d56d462539776adac1">Commit</a>)</p></li>
<li><p>弃用 <code>.find</code> 或 <code>.exists?</code> 可传入 Active Record 对象。请先对对象呼叫 <code>#id</code>。
(Commit <a href="https://github.com/rails/rails/commit/d92ae6ccca3bcfd73546d612efaea011270bd270">1</a>,
<a href="https://github.com/rails/rails/commit/d35f0033c7dec2b8d8b52058fb8db495d49596f7">2</a>)</p></li>
<li>
<p>弃用仅支持一半的 PostgreSQL 范围数值（不包含起始值）。目前我们把 PostgreSQL 的范围对应到 Ruby 的范围。但由于 Ruby 的范围不支援不包含起始值，所以无法完全转换。</p>
<p>目前的解决方法是将起始数递增，这是不对的，已经弃用了。关于不知如何递增的子类型（比如没有定义 <code>#succ</code>）会对不包含起始值的抛出 <code>ArgumentError</code>。</p>
<p>(<a href="https://github.com/rails/rails/commit/91949e48cf41af9f3e4ffba3e5eecf9b0a08bfc3">Commit</a>)</p>
</li>
</ul>
<h4 id="active-record-值得一提的变化">7.3 值得一提的变化</h4>
<ul>
<li><p>单数关联增加 <code>:required</code> 选项，用来定义关联的存在性验证。
(<a href="https://github.com/rails/rails/pull/16056">Pull Request</a>)</p></li>
<li><p>导入 <code>ActiveRecord::Base#validate!</code>，若记录不合法时会抛出 <code>RecordInvalid</code>。
(<a href="https://github.com/rails/rails/pull/8639">Pull Request</a>)</p></li>
<li><p><code>ActiveRecord::Base#reload</code> 现在的行为同 <code>m = Model.find(m.id)</code>，代表不再给自定的
<code>select</code> 保存额外的属性。
(<a href="https://github.com/rails/rails/pull/15866">Pull Request</a>)</p></li>
<li><p>导入 <code>bin/rake db:purge</code> 任务，用来清空当前环境的数据库。
(<a href="https://github.com/rails/rails/commit/e2f232aba15937a4b9d14bd91e0392c6d55be58d">Commit</a>)</p></li>
<li><p><code>ActiveRecord::Dirty</code> 现在会侦测可变数值的变化。序列化过的属性只在有变更时才会保存。
修复了像是 PostgreSQL 不会侦测到字串或 JSON 栏位改变的问题。
(Pull Requests <a href="https://github.com/rails/rails/pull/15674">1</a>,
<a href="https://github.com/rails/rails/pull/15786">2</a>,
<a href="https://github.com/rails/rails/pull/15788">3</a>)</p></li>
<li><p>新增 <code>ActiveRecord::Base</code> 对象的 <code>#pretty_print</code> 方法。
(<a href="https://github.com/rails/rails/pull/15172">Pull Request</a>)</p></li>
<li><p>PostgreSQL 与 SQLite 适配器不再默认限制字串只能 255 字符。
(<a href="https://github.com/rails/rails/pull/14579">Pull Request</a>)</p></li>
<li><p><code>sqlite3:///some/path</code> 现在可以解析系统的绝对路径 <code>/some/path</code>。
相对路径请使用 <code>sqlite3:some/path</code>。(先前是 <code>sqlite3:///some/path</code>
会解析成 <code>some/path</code>。这个行为已在 Rails 4.1 被弃用了。  Rails 4.1.)
(<a href="https://github.com/rails/rails/pull/14569">Pull Request</a>)</p></li>
<li><p>引入 <code>#validate</code> 作为 <code>#valid?</code> 的别名。
(<a href="https://github.com/rails/rails/pull/14456">Pull Request</a>)</p></li>
<li><p><code>#touch</code> 现在可一次对多属性操作。
(<a href="https://github.com/rails/rails/pull/14423">Pull Request</a>)</p></li>
<li><p>新增 MySQL 5.6 以上版本的 fractional seconds 支持。
(Pull Request <a href="https://github.com/rails/rails/pull/8240">1</a>, <a href="https://github.com/rails/rails/pull/14359">2</a>)</p></li>
<li><p>新增 PostgreSQL 适配器的 <code>citext</code> 支持。
(<a href="https://github.com/rails/rails/pull/12523">Pull Request</a>)</p></li>
<li><p>新增 PostgreSQL 适配器的使用自建的范围类型支持。
(<a href="https://github.com/rails/rails/commit/4cb47167e747e8f9dc12b0ddaf82bdb68c03e032">Commit</a>)</p></li>
</ul>
<h3 id="active-model">8 Active Model</h3><p>请参考 <a href="https://github.com/rails/rails/blob/4-2-stable/activemodel/CHANGELOG.md">CHANGELOG</a> 来了解更多细节。</p><h4 id="active-model-移除">8.1 移除</h4>
<ul>
<li>移除了 <code>Validator#setup</code>，没有替代方案。
(<a href="https://github.com/rails/rails/pull/15617">Pull Request</a>)</li>
</ul>
<h4 id="active-model-值得一提的变化">8.2 值得一提的变化</h4>
<ul>
<li><p><code>ActiveModel::Dirty</code> 导入 <code>undo_changes</code> 方法，用来恢复变更的属性到先前的数值。
(<a href="https://github.com/rails/rails/pull/14861">Pull Request</a>)</p></li>
<li><p>若启用验证，<code>has_secure_password</code> 现在会检查密码是否少于 72 个字符。
(<a href="https://github.com/rails/rails/pull/15708">Pull Request</a>)</p></li>
<li><p>引入 <code>#validate</code> 作为 <code>#valid?</code> 的别名。
(<a href="https://github.com/rails/rails/pull/14456">Pull Request</a>)</p></li>
</ul>
<h3 id="active-support">9 Active Support</h3><p>请参考 <a href="https://github.com/rails/rails/blob/4-2-stable/activesupport/CHANGELOG.md">CHANGELOG</a> 来了解更多细节。</p><h4 id="active-support-移除">9.1 移除</h4>
<ul>
<li><p>移除弃用的 <code>Numeric#ago</code>、<code>Numeric#until</code>、<code>Numeric#since</code> 以及
<code>Numeric#from_now</code>. (<a href="https://github.com/rails/rails/commit/f1eddea1e3f6faf93581c43651348f48b2b7d8bb">Commit</a>)</p></li>
<li><p>移除弃用 <code>ActiveSupport::Callbacks</code> 基于字串的终止符。
(<a href="https://github.com/rails/rails/pull/15100">Pull Request</a>)</p></li>
</ul>
<h4 id="弃用">9.2 弃用</h4>
<ul>
<li><p>弃用 <code>Class#superclass_delegating_accessor</code>，请改用 <code>Class#class_attribute</code>。
(<a href="https://github.com/rails/rails/pull/14271">Pull Request</a>)</p></li>
<li><p>弃用 <code>ActiveSupport::SafeBuffer#prepend!</code> 请改用 <code>ActiveSupport::SafeBuffer#prepend</code>（两者特性相同）。
(<a href="https://github.com/rails/rails/pull/14529">Pull Request</a>)</p></li>
</ul>
<h4 id="值得一提的变化">9.3 值得一提的变化</h4>
<ul>
<li><p>新增 <code>Hash#transform_values</code> 与 <code>Hash#transform_values!</code> 方法，来简化 Hash
值需要更新、但键保留不变这样的常见模式。
(<a href="https://github.com/rails/rails/pull/15819">Pull Request</a>)</p></li>
<li><p><code>humanize</code> 现在会去掉前面的底线。
(<a href="https://github.com/rails/rails/commit/daaa21bc7d20f2e4ff451637423a25ff2d5e75c7">Commit</a>)</p></li>
<li><p>导入 <code>Concern#class_methods</code> 来取代 <code>module ClassMethods</code> 以及 <code>Kernel#concern</code>，
来避免使用 <code>module Foo; extend ActiveSupport::Concern; end</code> 这样的样板。
(<a href="https://github.com/rails/rails/commit/b16c36e688970df2f96f793a759365b248b582ad">Commit</a>)</p></li>
</ul>
<h3 id="致谢">10 致谢</h3><p>许多人花费宝贵的时间贡献至 Rails 项目，使 Rails 成为更稳定、更强韧的网络框架，参考<a href="http://contributors.rubyonrails.org/">完整的 Rails 贡献者清单</a>，感谢所有的贡献者！</p>

        <h3>反馈</h3>
        <p>
          欢迎帮忙改善指南质量。
        </p>
        <p>
          如发现任何错误，欢迎修正。开始贡献前，可先行阅读<a href="http://edgeguides.rubyonrails.org/contributing_to_ruby_on_rails.html#contributing-to-the-rails-documentation">贡献指南：文档</a>。
        </p>
        <p>翻译如有错误，深感抱歉，欢迎 <a href="https://github.com/ruby-china/guides/fork">Fork</a> 修正，或至此处<a href="https://github.com/ruby-china/guides/issues/new">回报</a>。</p>
        <p>
          文章可能有未完成或过时的内容。请先检查 <a href="http://edgeguides.rubyonrails.org">Edge Guides</a> 来确定问题在 master 是否已经修掉了。再上 master 补上缺少的文件。内容参考 <a href="ruby_on_rails_guides_guidelines.html">Ruby on Rails 指南准则</a>来了解行文风格。
        </p>
        <p>最后，任何关于 Ruby on Rails 文档的讨论，欢迎到 <a href="http://groups.google.com/group/rubyonrails-docs">rubyonrails-docs 邮件群组</a>。
        </p>
      </div>
    </div>
  </div>

  <hr class="hide" />
  <div id="footer">
    <div class="wrapper">
      <p>本著作采用<a href="https://creativecommons.org/licenses/by-sa/4.0/">创用 CC 姓名标示-相同方式分享 4.0 国际授权条款</a>授权。</p>
<p>“Rails”、“Ruby on Rails”，以及 Rails logo 为 David Heinemeier Hansson 的商标。版权所有。</p>

    </div>
  </div>

  <script type="text/javascript" src="javascripts/jquery.min.js"></script>
  <script type="text/javascript" src="javascripts/responsive-tables.js"></script>
  <script type="text/javascript" src="javascripts/guides.js"></script>
  <script type="text/javascript" src="javascripts/syntaxhighlighter/shCore.js"></script>
  <script type="text/javascript" src="javascripts/syntaxhighlighter/shBrushRuby.js"></script>
  <script type="text/javascript" src="javascripts/syntaxhighlighter/shBrushXml.js"></script>
  <script type="text/javascript" src="javascripts/syntaxhighlighter/shBrushSql.js"></script>
  <script type="text/javascript" src="javascripts/syntaxhighlighter/shBrushPlain.js"></script>
  <script type="text/javascript">
    SyntaxHighlighter.all();
    $(guidesIndex.bind);
  </script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    // ga('create', '', 'ruby-china.github.io');
    ga('require', 'displayfeatures');
    ga('send', 'pageview');

  </script>
</body>
</html>
